<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{Dashboard :: layout(~{::title}, ~{::content})}">
<head>
    <title th:fragment="title">Ventas | Soporte</title>
</head>
<body>

<main class="content-area" th:fragment="content">

    <div class="view-header">
        <a th:href="@{/soporte/dashboard}" class="back-button">
            <i class="fas fa-arrow-left"></i>
        </a>
        <h1 class="content-title">Ventas</h1>
    </div>

    <div class="filters-container">
        <div class="filter-group-top">
            <select class="filter-select">
                <option value="">Selecciona sucursal</option>
                <option value="matriz">Matriz</option>
                <option value="sucursal-a">Sucursal A</option>
                <option value="sucursal-b">Sucursal B</option>
            </select>

            <input type="month" class="filter-input" placeholder="Selecciona Mes">

            <select class="filter-select" style="max-width: 150px;">
                <option value="q1">1ª Quincena</option>
                <option value="q2">2ª Quincena</option>
            </select>

            <button class="filter-button">Confirmar</button>

            <button id="btnEditarModo" class="action-button-primary" style="background-color: #3b5998; margin-left: auto;">
                <i class="fas fa-pen"></i> Editar
            </button>
        </div>
    </div>

    <h3 class="section-subtitle">Con Gastos</h3>

    <div class="table-container table-container-wide">
        <table class="data-table table-ventas">
            <thead>
            <tr class="header-row-blue">
                <th class="col-sticky">Empleado</th>
                <th colspan="15" style="text-align: center;">Días del 1 al 15 del mes</th>
                <th>Total</th>
            </tr>

            <tr class="header-row-days">
                <th class="col-sticky">Nombre</th>
                <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th>
                <th>6</th><th>7</th><th>8</th><th>9</th><th>10</th>
                <th>11</th><th>12</th><th>13</th><th>14</th><th>15</th>
                <th>Sumatoria</th>
            </tr>
            </thead>

            <tbody>
            <tr>
                <td class="col-sticky">Carlos (Soporte)</td>
                <td>$200</td><td>$0</td><td>$150</td><td>$300</td><td>$0</td>
                <td>$80</td><td>$100</td><td>$50</td><td>$0</td><td>$200</td>
                <td>$0</td><td>$120</td><td>$0</td><td>$150</td><td>$200</td>
                <td class="col-total-row">$1,350</td>
            </tr>

            <tr>
                <td class="col-sticky">Martha (Soporte)</td>
                <td>$300</td><td>$50</td><td>$0</td><td>$200</td><td>$0</td>
                <td>$0</td><td>$150</td><td>$200</td><td>$0</td><td>$250</td>
                <td>$100</td><td>$0</td><td>$100</td><td>$0</td><td>$50</td>
                <td class="col-total-row">$1,400</td>
            </tr>
            </tbody>

            <tfoot>
            <tr>
                <td class="col-sticky total-label">TOTAL GLOBAL</td>
                <td colspan="15"></td>
                <td class="grand-total">$2,750</td>
            </tr>
            </tfoot>
        </table>
    </div>

    <div style="height: 3rem;"></div>

    <h3 class="section-subtitle">Sin Gastos</h3>

    <div class="table-container table-container-wide">
        <table class="data-table table-ventas">
            <thead>
            <tr class="header-row-blue">
                <th class="col-sticky">Empleado</th>
                <th colspan="15" style="text-align: center;">Días del 1 al 15 del mes</th>
                <th>Total</th>
            </tr>

            <tr class="header-row-days">
                <th class="col-sticky">Nombre</th>
                <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th>
                <th>6</th><th>7</th><th>8</th><th>9</th><th>10</th>
                <th>11</th><th>12</th><th>13</th><th>14</th><th>15</th>
                <th>Sumatoria</th>
            </tr>
            </thead>

            <tbody>
            <tr>
                <td class="col-sticky">Carlos (Soporte)</td>
                <td>$350</td><td>$0</td><td>$200</td><td>$300</td><td>$0</td>
                <td>$100</td><td>$150</td><td>$100</td><td>$0</td><td>$300</td>
                <td>$0</td><td>$150</td><td>$0</td><td>$200</td><td>$250</td>
                <td class="col-total-row">$2,100</td>
            </tr>
            </tbody>

            <tfoot>
            <tr>
                <td class="col-sticky total-label">TOTAL GLOBAL</td>
                <td colspan="15"></td>
                <td class="grand-total">$2,100</td>
            </tr>
            </tfoot>
        </table>
    </div>

    <script th:inline="javascript">
        document.addEventListener('DOMContentLoaded', function() {
            const btnEditar = document.getElementById('btnEditarModo');
            const tablas = document.querySelectorAll('.table-ventas');
            let esEditable = false;

            btnEditar.addEventListener('click', function() {
                esEditable = !esEditable;

                tablas.forEach(tabla => {
                    const celdas = tabla.querySelectorAll('tbody td:not(.col-sticky):not(.col-total-row)');
                    celdas.forEach(c => c.setAttribute('contenteditable', esEditable));

                    if (esEditable) tabla.classList.add('modo-edicion');
                    else tabla.classList.remove('modo-edicion');
                });

                if (esEditable) {
                    this.innerHTML = '<i class="fas fa-save"></i> Guardar';
                    this.style.backgroundColor = '#28a745';
                } else {
                    this.innerHTML = '<i class="fas fa-pen"></i> Editar';
                    this.style.backgroundColor = '#3b5998';
                    alert("Ventas actualizadas.");
                }
            });
        });
    </script>

</main>
</body>
</html>
